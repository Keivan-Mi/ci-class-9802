# -*- coding: utf-8 -*-
"""Housing Price Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/17oc-LuRGM06mtYAmppoQyYGTg7XBEbKj
"""

import keras
import numpy as np
import pandas as pd

df=pd.read_csv('house-3.csv')
df.head()

df.describe()

dumm = pd.get_dummies(df.mahalle)
dumm.head(3)

df2=pd.concat([df,dumm],axis='columns')
df2.head()

df3=df2.drop('mahalle',axis='columns')
df3.head()

df3.isna().sum()
df3 = df3.astype(float)
df3.dtypes

x=df3.drop(columns=['price'])
y=df3[['price']]

model=keras.models.Sequential()

model.add(keras.layers.Dense(18,activation='relu',input_shape=(17,)))
model.add(keras.layers.Dense(9,activation='relu'))
model.add(keras.layers.Dense(1))

model.compile(optimizer='adam',loss='mean_squared_error')

model.fit(x,y,epochs=30,callbacks=[keras.callbacks.EarlyStopping(patience=5)])

test_data = np.array([69,1,0,98,3,0,1,0,0,0,0,0,0,0,0,0,0])
print(model.predict(test_data.reshape(1,17), batch_size=1))